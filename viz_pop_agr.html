<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Cropland vs Population</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

    <link href="https://api.mapbox.com/mapbox-gl-js/v3.17.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.17.0/mapbox-gl.js"></script>
    <link href='MapboxHousePrice_example_styles.css' rel='stylesheet' />  
    
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>

<body>

<div id='map'></div>

<script>  // This is the mapbox base
    mapboxgl.accessToken = 'pk.eyJ1IjoidGJ0YWFhIiwiYSI6ImNta2xoNnYzejA0ZG4zZnBoOXFsbjJnY3kifQ.uYS3fcXXVnpjRIhd4GSWOA';

    // Load a new map in the 'map' HTML div
    var map = new mapboxgl.Map({
    container: 'map', // container id
    style: 'mapbox://styles/tbtaaa/cml1h8rbt001t01sg0gp4fuy6', // location of the stylesheet with the house price data layers included
    center: [-2.5, 52], // starting position [lng, lat]
    zoom: 5, // starting zoom
    hash: true
    });

 map.addControl(new mapboxgl.NavigationControl());
 map.addControl(new mapboxgl.ScaleControl(), 'bottom-right');

// disable map rotation using right click + drag
map.dragRotate.disable();

// disable map rotation using touch rotation gesture
map.touchZoomRotate.disableRotation();

map.on('load', () => {

      map.addSource("countries-src", {
        type: "vector",
        url: "mapbox://tbtaaa.74s6scc0",
        maxzoom: 8.5
      });

      // This must match the source-layer name INSIDE the tileset
      const SOURCE_LAYER = "world_boundaries-dpk3jr";

      // This must match the attribute name in your tileset properties
      const NAME_FIELD = "NAM_0";

    map.addLayer({ 
            id: 'Countries',
            type: 'fill',
            source:  "countries-src",
            "source-layer": SOURCE_LAYER,
            paint: {
                'fill-color': '#fff',
                'fill-opacity': 0
                }
          });

    map.addLayer({ 
            id: 'lahighlight',
            type: 'line',
            source: "countries-src",
            "source-layer": SOURCE_LAYER,
            paint: {
                'line-color': '#adf',
                'line-width': 3
                },
            filter: ["==", ["get", NAME_FIELD], ""]
          });

      map.on("mousemove", "Countries", (e) => {
        map.getCanvas().style.cursor = "pointer";

        if (!e.features || !e.features.length) return;

        const f = e.features[0];
        const hoveredName = f.properties?.[NAME_FIELD];

        if (hoveredName == null) {
          return;
        }

        map.setFilter("lahighlight", ["==", ["get", NAME_FIELD], hoveredName]);
      });

      map.on("mouseleave", "Countries", () => {
        map.getCanvas().style.cursor = "";
        map.setFilter("lahighlight", ["==", ["get", NAME_FIELD], ""]);
      });

});

</script>

</body>
</html>
